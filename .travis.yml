sudo: required
language: bash
before_deploy:
#  - eval "($ssh-agent -s)"
  - mkdir -p ~/.ssh && echo "Host *" > ~/.ssh/config && echo " StrictHostKeyChecking no" >> ~/.ssh/config
  - chmod 600 home.pem
deploy:
  provider: script
  skip_cleanup: true
  script: 
    - ssh -i home.pem ubuntu@ec2-18-223-151-157.us-east-2.compute.amazonaws.com 'docker-compose --version && cd ttt/dream-cd-test && git pull && cd test-docker-compose && pwd && echo "STOP DOCKER COMPOSE" && sudo docker-compose down && sudo docker-compose up -d && sudo docker-compose ps && sudo docker ps'
    #- ssh -i home.pem ubuntu@ec2-18-223-151-157.us-east-2.compute.amazonaws.com 'cd ttt/dream-cd-test && git pull'
    #- ssh -i home.pem ubuntu@ec2-18-223-151-157.us-east-2.compute.amazonaws.com 'sudo docker-compose -f ~/ttt/dream-cd-test/test-docker-compose/docker-compose.yml down'
    #- ssh -i home.pem ubuntu@ec2-18-223-151-157.us-east-2.compute.amazonaws.com 'sudo docker-compose -f ~/ttt/dream-cd-test/test-docker-compose/docker-compose.yml -d up'
    #- ssh -i home.pem ubuntu@ec2-18-223-151-157.us-east-2.compute.amazonaws.com 'sudo docker-compose -f ~/ttt/dream-cd-test/test-docker-compose/docker-compose.yml ps'
    #- ssh -i home.pem ubuntu@ec2-18-223-151-157.us-east-2.compute.amazonaws.com 'sudo docker ps'
  on:
    branch: master
before_install:
- openssl aes-256-cbc -K $encrypted_9e6a438b5ac7_key -iv $encrypted_9e6a438b5ac7_iv
  -in home.pem.enc -out home.pem -d
